<% provide(:title, 'New post') %>

<div class="container">
  <h1>Create new post</h1>

  <div class="about-user">
    <h2>
      <%= link_to gravatar_for(current_user, size: 50), current_user %>
    </h2>
    <h2><%= current_user.name %></h2>
    <span><%= link_to "view my profile", current_user %></span>
    <span><%= pluralize(current_user.microposts.count, "micropost") %></span>
  </div>

  <%= form_with(model: @micropost, local: true) do |f| %>
    <%= render 'shared/error_messages', object: f.object %>
    <div class="field">
      <%= f.text_area :content, placeholder: "Compose new micropost..." %>
      <span class="image">
      <%= f.file_field :image, accept: "image/jpeg,image/png" %>
      </span>
    </div>
    <%= f.submit "Post", class: "btn btn-primary" %>
    <% end %>
  </div>

  <script type="text/javascript">
    $("#micropost_image").bind("change", function() {
      var size_in_megabytes = this.files[0].size/1024/1024;
      if (size_in_megabytes > 5) {
        alert("Maximum file size is 5MB. Please choose a smaller file.");
        $("#micropost_image").val("");
      }
    });
  </script>
</div>